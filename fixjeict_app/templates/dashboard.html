{% extends "base.html" %}

{% block title %}Dashboard - FixJeICT{% endblock %}

{% block content %}
<section class="section section-dashboard">
    <div class="container">
        <div class="dashboard-header">
            <div>
                <h1>Welkom terug, {{ user.name }}!</h1>
                <p class="dashboard-subtitle">Beheer uw tickets en opvolging</p>
            </div>
            <a href="{{ url_for('new_ticket') }}" class="btn btn-primary">+ Nieuw Ticket</a>
        </div>

        <div class="dashboard-stats">
            <div class="stat-card">
                <h3>Totaal Tickets</h3>
                <div class="value">{{ tickets|length }}</div>
            </div>
            <div class="stat-card">
                <h3>Open</h3>
                <div class="value">{{ tickets|selectattr('status', 'equalto', 'Open')|list|length }}</div>
            </div>
            <div class="stat-card">
                <h3>In Behandeling</h3>
                <div class="value">{{ tickets|selectattr('status', 'equalto', 'In behandeling')|list|length }}</div>
            </div>
            <div class="stat-card">
                <h3>Voltooid</h3>
                <div class="value">{{ tickets|selectattr('status', 'equalto', 'Gereed')|list|length }}</div>
            </div>
        </div>

        <div class="dashboard-section">
            <h2>Mijn Tickets</h2>
            {% if tickets %}
            <div class="ticket-list">
                {% for ticket in tickets %}
                <div class="ticket-item">
                    <div class="ticket-main">
                        <div class="ticket-id">#{{ ticket.id }}</div>
                        <div class="ticket-info">
                            <h3><a href="{{ url_for('ticket_detail', id=ticket.id) }}">{{ ticket.title }}</a></h3>
                            <div class="ticket-meta">
                                {% if ticket.category %}
                                <span class="badge badge-category">{{ ticket.category.name }}</span>
                                {% endif %}
                                <span class="badge badge-priority-{{ ticket.priority }}">{{ ticket.priority|capitalize }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="ticket-status">
                        <span class="badge badge-status badge-status-{{ ticket.status|replace(' ', '-')|lower }}">{{ ticket.status }}</span>
                        <div class="ticket-date">{{ ticket.updated_at.strftime('%d-%m-%Y') }}</div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <div class="empty-icon">ðŸ“‹</div>
                <h3>Geen tickets gevonden</h3>
                <p>U heeft nog geen tickets aangemaakt.</p>
                <a href="{{ url_for('new_ticket') }}" class="btn btn-primary">Maak uw eerste ticket aan</a>
            </div>
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}
